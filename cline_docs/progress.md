# 项目进度

## 已完成功能

- **`SpikeNet-X` 原型实现**:
  - `spikenet_x` 目录下的所有核心模块已完成。
  - 模型可以通过 `spikenet_x/minimal_example.py` 进行验证。
- **`main.py` 集成与稀疏 STA**:
  - `main.py` 支持通过 `--model spikenetx` 调用模型。
  - 实现了 O(E) 复杂度的稀疏 STA 注意力机制，解决了大型图上的内存溢出问题。
- **`SpikeNet-X` 训练流程修复**:
  - **状态**: **已完成**
  - **描述**: 成功定位并修复了稀疏 STA 实现中的 `RuntimeError` (in-place 操作错误)。模型现在可以在大型数据集上稳定运行。
- **训练框架功能增强**:
  - **状态**: **已完成**
  - **描述**: 为 `main.py` 增加了关键的工程能力，包括：
    - 基于验证集性能的模型自动保存。
    - 从检查点文件恢复训练的断点续训功能。
    - 用于快速评估已保存模型的独立测试模式。

## 需要构建的内容

- **基线模型性能评估**:

  - **状态**: **未开始**
  - **描述**: 在 DBLP 数据集上运行一次完整的端到端训练，获得基线性能指标（如 Macro/Micro-F1），为后续优化提供参考。
- **超参数调优**:

  - **状态**: **未开始**
  - **描述**: 在获得基线性能后，系统性地对模型的关键超参数（如学习率, 时间窗口, 注意力头数等）进行调优，以最大化模型性能。

## 进度状态

- **`SpikeNet-X` 功能**: **已就绪 (READY FOR EXPERIMENTS)**
- **原因**: 核心的 `RuntimeError` 已修复，训练流程稳定。同时，模型保存、断点续训等关键功能的加入，使得进行系统性的实验和调优成为可能。项目已从“功能解锁”阶段推进到“实验与优化”阶段。

## 2025-09-14 更新

- ✅ **修复子图边集错误**：`sample_subgraph` 现在保留子图内部所有边（src/dst ∈ 子图）。
- ✅ **读出策略统一**：SpikeNet-X 改为 `readout="mean"`。
- ✅ **训练实现切换**：默认用 `attn_impl=dense`，启用 `--topk`；`W` 推荐 32。
- ✅ **邻居采样放宽**：`num_neighbors_to_sample=25`（可按显存调节或 `-1`）。
- 🔄 **DBLP 基线复现（SpikeNet-X）**：100 epoch，记录 Macro/Micro-F1（目标：≥ SpikeNet 同量级）。
- 📌 **超参网格**：`W∈{16,32,64}` × `topk∈{8,16}` × `heads∈{2,4}`。

## 待办清单

- [ ] 跑满 DBLP 100 epoch（dense, W=32, topk=8）。
- [ ] 对比 `readout=last` vs `mean` 的消融。
- [ ] sparse 实现的 Top-k 与 CUDA 化评估。
